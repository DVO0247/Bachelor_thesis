<div id="start_stop" class="d-flex flex-column align-items-start" hx-get="{% url 'reload_start_stop_panel' %}"
    hx-trigger="every 3s" hx-swap="outerHTML" style="overflow-x: auto;">
    <table class="table table-striped table-bordered" style="table-layout: auto; width: 100%;">
        <thead>
            <tr>
                <th style="white-space: nowrap;">Name</th>
                <th style="white-space: nowrap;">M ID</th>
                <th style="white-space: nowrap;"></th>
            </tr>   
        </thead>
        <tbody>
            {% for user_project in user_projects %}
            {% if user_project.is_activated %}
            {% with project=user_project.project %}
            {% with last_measurement=project.get_last_measurement %}
            <tr>
                <td class="align-middle" style="word-wrap: break-word; white-space: normal; word-break: break-word;">
                    <a href="{% url 'project_sensor_node_list' project.pk %}"
                        style="color: {{ user.darkmode|yesno:'white,black' }};">
                        {{ project.name }}
                    </a>
                </td>
                <td class="align-middle">
                    {% if last_measurement %}
                    {{ last_measurement.get_next_or_running_id }}
                    {% else %}
                    0
                    {% endif %}
                </td>
                <td class="align-middle text-center">
                    <form method="post" style="display:inline;">
                        {% csrf_token %}
                        {% if not project.is_running %}
                        <button class="btn btn-success btn-sm btn-short"
                            hx-post="{% url 'start_measurement' project.pk %}" hx-target="#start_stop"
                            hx-swap="outerHTML">
                            Start
                        </button>
                        {% else %}
                        <button class="btn btn-danger btn-sm btn-short"
                            hx-post="{% url 'stop_measurement' project.pk %}" hx-target="#start_stop"
                            hx-swap="outerHTML">
                            Stop
                        </button>
                        {% endif %}
                    </form>
                </td>
            </tr>
            {% endwith %}
            {% endwith %}
            {% endif %}
            {% endfor %}
        </tbody>
    </table>
</div>
